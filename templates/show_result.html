<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Loading</title>
    </head>
    <body>
            <p id="wait_msg">Processing image</p>
    </body>
    <script>
        filename = window.location.pathname.split("/").slice(-1)[0];
        postRequstUrl = "/process_image";

        window.onload = function() {
            var xhr = new XMLHttpRequest();
            xhr.open("POST", postRequstUrl, true);
            xhr.setRequestHeader('Content-Type', "application/json");
            requestData = JSON.stringify({
                "filename": filename
            })
                xhr.send(requestData);
            xhr.onreadystatechange = function () {
                if (this.readyState != 4) return;
                if (this.status == 200) {
                    var outputImage = document.createElement("img");
                    outputImage.src = 'data:image/png;charset=utf-8;base64, '+this.responseText;
                    document.getElementById("wait_msg").remove();
                    document.body.appendChild(outputImage);
                }
            }
        }
    </script>
</html>